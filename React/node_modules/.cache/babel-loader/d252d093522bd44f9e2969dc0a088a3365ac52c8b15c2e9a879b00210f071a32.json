{"ast":null,"code":"var _jsxFileName = \"/Users/chenhan/Desktop/eti_assignment2/React/src/components/RegisterTutor.js\",\n  _s = $RefreshSig$();\nimport React, { ChangeEvent, useState, useRef } from \"react\";\nimport * as ReactDOM from 'react-dom';\nimport Form from \"react-validation/build/form\";\nimport Input from \"react-validation/build/input\";\nimport CheckButton from \"react-validation/build/button\";\nimport DropdownMultiselect from \"react-multiselect-dropdown-bootstrap\";\nimport { isEmail } from \"validator\";\nimport AuthService from \"../services/auth.service\";\nimport SubjectServices from \"../services/subject.service\";\nimport { useNavigate } from \"react-router-dom\";\nimport TimePicker from 'react-bootstrap-time-picker';\nimport { initializeApp } from \"firebase/app\";\nimport { getStorage } from \"firebase/storage\";\nimport { ref, uploadBytesResumable, getDownloadURL } from \"firebase/storage\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst required = value => {\n  if (!value) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"invalid-feedback d-block\",\n      children: \"This field is required!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 22,\n      columnNumber: 7\n    }, this);\n  }\n};\nconst validEmail = value => {\n  if (!isEmail(value)) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"invalid-feedback d-block\",\n      children: \"This email cannot be registered!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 32,\n      columnNumber: 7\n    }, this);\n  }\n};\nconst vpassword = value => {\n  if (value.length < 8 || value.length > 40) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"invalid-feedback d-block\",\n      children: \"The password must be between 8 and 40 characters.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 7\n    }, this);\n  }\n};\nconst RegisterTutor = () => {\n  _s();\n  const firebaseConfig = {\n    apiKey: \"AIzaSyC1fuJ1HYNnv5o2_UauLPx7wwgQGj_Jcpc\",\n    authDomain: \"eti-assignment-2.firebaseapp.com\",\n    databaseURL: \"https://eti-assignment-2-default-rtdb.asia-southeast1.firebasedatabase.app\",\n    projectId: \"eti-assignment-2\",\n    storageBucket: \"eti-assignment-2.appspot.com\",\n    messagingSenderId: \"903055257140\",\n    appId: \"1:903055257140:web:676b8fbb0dfc642dbca461\",\n    measurementId: \"G-986C89B33B\"\n  };\n  const app = initializeApp(firebaseConfig);\n  const storage = getStorage(app);\n  const form = useRef();\n  const checkBtn = useRef();\n  const [name, setName] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [hourlyRate, setHourlyRate] = useState(50);\n  const [startTime, setStartTime] = useState(\"08:00\");\n  const [startForEndTime, setStartForEndTime] = useState(\"09:00\");\n  const [endTime, setEndTime] = useState(\"10:00\");\n  const [availability, setAvailability] = useState({});\n  const [selectedSubjects, setSelectedSubjects] = useState({\n    \"PSLE\": [],\n    \"O-Level\": [],\n    \"A-Level\": []\n  });\n\n  // Maximum 5 files\n  const MAX_COUNT = 5;\n  const [uploadedFiles, setUploadedFiles] = useState([]);\n  const [fileLimit, setFileLimit] = useState(false);\n  const [uploadedURLs, setUploadedURLs] = useState([]);\n  const subjects = SubjectServices.getAllSubjects();\n  const PSLESubjects = subjects[\"PSLE\"].sort();\n  const OlevelSubjects = subjects[\"O-Level\"].sort();\n  const AlevelSubjects = subjects[\"A-Level\"].sort();\n  const PSLEArray = [];\n  for (let i = 0; i < PSLESubjects.length; i++) {\n    var value = PSLESubjects[i];\n    PSLEArray.push({\n      key: value,\n      label: value\n    });\n  }\n  const OLevelArray = [];\n  for (let i = 0; i < OlevelSubjects.length; i++) {\n    var value = OlevelSubjects[i];\n    OLevelArray.push({\n      key: value,\n      label: value\n    });\n  }\n  const ALevelArray = [];\n  for (let i = 0; i < AlevelSubjects.length; i++) {\n    var value = AlevelSubjects[i];\n    ALevelArray.push({\n      key: value,\n      label: value\n    });\n  }\n  const weekdayArray = [{\n    key: \"Monday\",\n    label: \"Monday\"\n  }, {\n    key: \"Tuesday\",\n    label: \"Tuesday\"\n  }, {\n    key: \"Wednesday\",\n    label: \"Wednesday\"\n  }, {\n    key: \"Thursday\",\n    label: \"Thursday\"\n  }, {\n    key: \"Friday\",\n    label: \"Friday\"\n  }, {\n    key: \"Saturday\",\n    label: \"Saturday\"\n  }, {\n    key: \"Sunday\",\n    label: \"Sunday\"\n  }];\n  const [successful, setSuccessful] = useState(false);\n  const [message, setMessage] = useState(\"\");\n  const navigate = useNavigate();\n  const onChangeEmail = e => {\n    const email = e.target.value;\n    setEmail(email);\n  };\n  const onChangeName = e => {\n    const name = e.target.value;\n    setName(name);\n  };\n  const onChangePassword = e => {\n    const password = e.target.value;\n    setPassword(password);\n  };\n  const onChangeHourlyRate = e => {\n    const hourlyRate = e.target.value;\n    setHourlyRate(hourlyRate);\n    document.getElementById(\"hourlyRate\").textContent = \"$\" + hourlyRate;\n  };\n  const onChangeStartTime = e => {\n    const startTime = new Date(e * 1000).toISOString().substring(11, 16);\n\n    // Add 30 mins \n    const startForEndTime = new Date((e + 1800) * 1000).toISOString().substring(11, 16);\n    setStartTime(startTime);\n    setStartForEndTime(startForEndTime);\n  };\n  const onChangeEndTime = e => {\n    const endTime = new Date(e * 1000).toISOString().substring(11, 16);\n    setEndTime(endTime);\n  };\n  const OnChangePSLE = subject => {\n    let updated = selectedSubjects;\n    updated[\"PSLE\"] = subject;\n    setSelectedSubjects(selectedSubjects => ({\n      ...updated\n    }));\n  };\n  const onChangeOlevel = subject => {\n    let updated = selectedSubjects;\n    updated[\"O-Level\"] = subject;\n    setSelectedSubjects(selectedSubjects => ({\n      ...updated\n    }));\n  };\n  const onChangeAlevel = subject => {\n    let updated = selectedSubjects;\n    updated[\"A-Level\"] = subject;\n    setSelectedSubjects(selectedSubjects => ({\n      ...updated\n    }));\n  };\n  const onChangeWeekDays = weekdays => {\n    let updatedValue = {};\n    for (var i = 0; i < weekdays.length; i++) {\n      updatedValue[weekdays[i]] = {\n        \"start\": \"\",\n        \"end\": \"\"\n      };\n    }\n    setAvailability(availability => ({\n      ...updatedValue\n    }));\n  };\n  const handleUploadFiles = files => {\n    const uploaded = [...uploadedFiles];\n    let limitExceeded = false;\n    files.some(file => {\n      if (uploaded.findIndex(f => f.name === file.name) === -1) {\n        uploaded.push(file);\n        if (uploaded.length === MAX_COUNT) setFileLimit(true);\n        if (uploaded.length > MAX_COUNT) {\n          alert(`You can only add a maximum of ${MAX_COUNT} files`);\n          setFileLimit(false);\n          limitExceeded = true;\n          return true;\n        }\n      }\n    });\n    if (!limitExceeded) setUploadedFiles(uploaded);\n  };\n  const handleFileEvent = e => {\n    const chosenFiles = Array.prototype.slice.call(e.target.files);\n    handleUploadFiles(chosenFiles);\n  };\n  const handleRegister = e => {\n    e.preventDefault();\n    setMessage(\"\");\n    setSuccessful(false);\n    form.current.validateAll();\n\n    //validate\n    if (uploadedFiles.length == 0) {\n      alert(\"Please uploade at least 1 file!\");\n    }\n\n    // If passed validation, call auth service to send the API request\n\n    if (checkBtn.current.context._errors.length === 0) {\n      // Consolidate the availbility\n      let updatedValue = availability;\n      var weekdays = Object.keys(availability);\n      for (var i = 0; i < weekdays.length; i++) {\n        updatedValue[weekdays[i]][\"start\"] = startTime;\n        updatedValue[weekdays[i]][\"end\"] = endTime;\n      }\n      setAvailability(availability => ({\n        ...availability,\n        ...updatedValue\n      }));\n\n      // upload the file to firebase storage\n      for (var i = 0; i < uploadedFiles.length; i++) {\n        const storageRef = ref(storage, `/${email}/${uploadedFiles[i].name}`);\n        const uploadTask = uploadBytesResumable(storageRef, uploadedFiles[i]);\n        uploadTask.on(\"state_changed\", () => {}, err => console.log(err), () => {\n          getDownloadURL(uploadTask.snapshot.ref).then(url => {\n            const uploaded = uploadedURLs;\n            uploaded.push(url);\n            setUploadedURLs(uploaded);\n          });\n        });\n        if (uploadedURLs.length === uploadedFiles.length) {\n          alert(\"Files uploaded successfully!\");\n          AuthService.register_tutor(name, email, password, hourlyRate, availability, selectedSubjects, uploadedURLs).then(response => {\n            if (response.status === 200) {\n              setMessage(\"Registered Successfully!\");\n              setSuccessful(true);\n              setTimeout(function () {\n                navigate(\"/login\");\n                window.location.reload();\n              }, 2000);\n            } else {\n              setMessage(\"Error, try again!\");\n              setSuccessful(false);\n              setTimeout(function () {\n                setMessage(\"\");\n              }, 5000);\n            }\n          }, error => {\n            var resMessage = \"\";\n            if (error.response.status === 406) {\n              resMessage = \"This email has been registered!\";\n            } else {\n              resMessage = error.response && error.response.data && error.response.data.message || error.message || error.toString();\n            }\n            setMessage(resMessage);\n            setSuccessful(false);\n          });\n        }\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(Form, {\n    onSubmit: handleRegister,\n    ref: form,\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Register Tutor\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 314,\n      columnNumber: 11\n    }, this), !successful && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"hr\", {\n        className: \"hr\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Basic Details\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"name\",\n          children: \"Name\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 321,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          type: \"text\",\n          className: \"form-control\",\n          name: \"name\",\n          value: name,\n          onChange: onChangeName,\n          validations: [required]\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 322,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 320,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"email\",\n          children: \"Email\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 333,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          type: \"text\",\n          name: \"email\",\n          className: \"form-control\",\n          value: email,\n          onChange: onChangeEmail,\n          validations: [required, validEmail]\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 334,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"password\",\n          children: \"Password\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 345,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          type: \"password\",\n          className: \"form-control\",\n          name: \"password\",\n          value: password,\n          onChange: onChangePassword,\n          validations: [required, vpassword]\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 346,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 344,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"hourlyrate\",\n          children: [\"Indicated Hourly Rate\", /*#__PURE__*/_jsxDEV(\"div\", {\n            id: \"hourlyRate\",\n            children: \"$50\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 357,\n            columnNumber: 66\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 357,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          type: \"range\",\n          min: \"10\",\n          max: \"100\",\n          className: \"form-control\",\n          step: 5,\n          value: hourlyRate,\n          onChange: onChangeHourlyRate,\n          validations: [required]\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 358,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 356,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {\n        className: \"hr\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 370,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Availabilities\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 371,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-3\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-4\",\n          id: \"addAvail\",\n          children: [/*#__PURE__*/_jsxDEV(DropdownMultiselect, {\n            options: weekdayArray,\n            name: \"weekdayArray\",\n            handleOnChange: selected => {\n              onChangeWeekDays(selected);\n            },\n            validations: [required]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 375,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Start\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 384,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(TimePicker, {\n            initialValue: \"08:00\",\n            start: \"00:00\",\n            end: \"23:59\",\n            step: 30,\n            value: startTime,\n            onChange: onChangeStartTime,\n            validations: [required]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 385,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"End\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 394,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(TimePicker, {\n            initialValue: \"10:00\",\n            start: startForEndTime,\n            end: \"23:59\",\n            step: 30,\n            value: endTime,\n            onChange: onChangeEndTime,\n            validations: [required]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 395,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 373,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 372,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {\n        className: \"hr\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 407,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Proficient Subjects\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 408,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"options\",\n          children: \"PSLE\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 410,\n          columnNumber: 19\n        }, this), /*#__PURE__*/_jsxDEV(DropdownMultiselect, {\n          options: PSLEArray,\n          name: \"pslesubjects\",\n          handleOnChange: selected => {\n            OnChangePSLE(selected);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 411,\n          columnNumber: 19\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 409,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"options\",\n          children: \"O-Level\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 418,\n          columnNumber: 19\n        }, this), /*#__PURE__*/_jsxDEV(DropdownMultiselect, {\n          options: OLevelArray,\n          name: \"olevelsubjects\",\n          handleOnChange: selected => {\n            onChangeOlevel(selected);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 419,\n          columnNumber: 19\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 417,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"options\",\n          children: \"A-Level\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 426,\n          columnNumber: 19\n        }, this), /*#__PURE__*/_jsxDEV(DropdownMultiselect, {\n          options: ALevelArray,\n          name: \"alevelsubjects\",\n          handleOnChange: selected => {\n            onChangeAlevel(selected);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 427,\n          columnNumber: 19\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 425,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {\n        className: \"hr\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 433,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Certificate of Evidence\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 434,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"alert alert-primary\",\n        role: \"alert\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mb-0\",\n          children: \"You may submit any document proving your ability as a Tutor for subjects indicated above\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 436,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 435,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"form-control\",\n          type: \"file\",\n          multiple: true,\n          id: \"formFileMultiple\",\n          onChange: handleFileEvent,\n          disabled: fileLimit\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 442,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"uploaded-files-list\",\n          children: uploadedFiles.map(file => /*#__PURE__*/_jsxDEV(\"div\", {\n            children: file.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 452,\n            columnNumber: 23\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 450,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 441,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-grid\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn btn-success btn-block\",\n          children: \"Register\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 461,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 460,\n        columnNumber: 15\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 13\n    }, this), message && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-3\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: successful ? \"alert alert-success\" : \"alert alert-danger\",\n        role: \"alert\",\n        children: message\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 468,\n        columnNumber: 15\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 467,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(CheckButton, {\n      style: {\n        display: \"none\"\n      },\n      ref: checkBtn\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 478,\n      columnNumber: 11\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 313,\n    columnNumber: 9\n  }, this);\n};\n_s(RegisterTutor, \"vbdeQeEJoKyN2RwI45nSYBaBSVc=\", false, function () {\n  return [useNavigate];\n});\n_c = RegisterTutor;\nexport default RegisterTutor;\nvar _c;\n$RefreshReg$(_c, \"RegisterTutor\");","map":{"version":3,"names":["React","ChangeEvent","useState","useRef","ReactDOM","Form","Input","CheckButton","DropdownMultiselect","isEmail","AuthService","SubjectServices","useNavigate","TimePicker","initializeApp","getStorage","ref","uploadBytesResumable","getDownloadURL","required","value","validEmail","vpassword","length","RegisterTutor","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","app","storage","form","checkBtn","name","setName","email","setEmail","password","setPassword","hourlyRate","setHourlyRate","startTime","setStartTime","startForEndTime","setStartForEndTime","endTime","setEndTime","availability","setAvailability","selectedSubjects","setSelectedSubjects","MAX_COUNT","uploadedFiles","setUploadedFiles","fileLimit","setFileLimit","uploadedURLs","setUploadedURLs","subjects","getAllSubjects","PSLESubjects","sort","OlevelSubjects","AlevelSubjects","PSLEArray","i","push","key","label","OLevelArray","ALevelArray","weekdayArray","successful","setSuccessful","message","setMessage","navigate","onChangeEmail","e","target","onChangeName","onChangePassword","onChangeHourlyRate","document","getElementById","textContent","onChangeStartTime","Date","toISOString","substring","onChangeEndTime","OnChangePSLE","subject","updated","onChangeOlevel","onChangeAlevel","onChangeWeekDays","weekdays","updatedValue","handleUploadFiles","files","uploaded","limitExceeded","some","file","findIndex","f","alert","handleFileEvent","chosenFiles","Array","prototype","slice","call","handleRegister","preventDefault","current","validateAll","context","_errors","Object","keys","storageRef","uploadTask","on","err","console","log","snapshot","then","url","register_tutor","response","status","setTimeout","window","location","reload","error","resMessage","data","toString","selected","map","display"],"sources":["/Users/chenhan/Desktop/eti_assignment2/React/src/components/RegisterTutor.js"],"sourcesContent":["import React, { ChangeEvent, useState, useRef } from \"react\";\nimport * as ReactDOM from 'react-dom';\nimport Form from \"react-validation/build/form\";\nimport Input from \"react-validation/build/input\";\nimport CheckButton from \"react-validation/build/button\";\nimport DropdownMultiselect from \"react-multiselect-dropdown-bootstrap\";\nimport { isEmail } from \"validator\";\n\nimport AuthService from \"../services/auth.service\";\nimport SubjectServices from \"../services/subject.service\";\nimport { useNavigate } from \"react-router-dom\";\n\nimport TimePicker from 'react-bootstrap-time-picker';\n\nimport { initializeApp } from \"firebase/app\";\nimport { getStorage } from \"firebase/storage\";\nimport {ref, uploadBytesResumable, getDownloadURL } from \"firebase/storage\"\n\nconst required = (value) => {\n  if (!value) {\n    return (\n      <div className=\"invalid-feedback d-block\">\n        This field is required!\n      </div>\n    );\n  }\n};\n\nconst validEmail = (value) => {\n  if (!isEmail(value)) {\n    return (\n      <div className=\"invalid-feedback d-block\">\n        This email cannot be registered!\n      </div>\n    );\n  }\n};\n\n\nconst vpassword = (value) => {\n  if (value.length < 8 || value.length > 40) {\n    return (\n      <div className=\"invalid-feedback d-block\">\n        The password must be between 8 and 40 characters.\n      </div>\n    );\n  }\n};\n\n\nconst RegisterTutor = () => {\n  const firebaseConfig = {\n    apiKey: \"AIzaSyC1fuJ1HYNnv5o2_UauLPx7wwgQGj_Jcpc\",\n    authDomain: \"eti-assignment-2.firebaseapp.com\",\n    databaseURL: \"https://eti-assignment-2-default-rtdb.asia-southeast1.firebasedatabase.app\",\n    projectId: \"eti-assignment-2\",\n    storageBucket: \"eti-assignment-2.appspot.com\",\n    messagingSenderId: \"903055257140\",\n    appId: \"1:903055257140:web:676b8fbb0dfc642dbca461\",\n    measurementId: \"G-986C89B33B\"\n  };\n\n  const app = initializeApp(firebaseConfig);\n  const storage = getStorage(app);\n  \n  const form = useRef();\n  const checkBtn = useRef();\n\n  const [name, setName] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [hourlyRate, setHourlyRate] = useState(50);\n  const [startTime, setStartTime] = useState(\"08:00\");\n  const [startForEndTime, setStartForEndTime] = useState(\"09:00\");\n  const [endTime, setEndTime] = useState(\"10:00\");\n  const [availability, setAvailability] = useState({});\n  const [selectedSubjects, setSelectedSubjects] = useState({\n    \"PSLE\" : [],\n    \"O-Level\": [],\n    \"A-Level\": []\n  });\n\n\n\n  // Maximum 5 files\n  const MAX_COUNT = 5;\n  const [uploadedFiles, setUploadedFiles] = useState([]);\n  const [fileLimit, setFileLimit] = useState(false);\n  const [uploadedURLs, setUploadedURLs] = useState([]);\n\n\n  const subjects = SubjectServices.getAllSubjects()\n  const PSLESubjects = subjects[\"PSLE\"].sort()\n  const OlevelSubjects = subjects[\"O-Level\"].sort()\n  const AlevelSubjects = subjects[\"A-Level\"].sort()\n\n\n  const PSLEArray = [];\n  for (let i = 0; i < PSLESubjects.length; i++) {\n    var value = PSLESubjects[i]\n    PSLEArray.push({key: value, label: value })\n  } \n\n  const OLevelArray = [];\n  for (let i = 0; i < OlevelSubjects.length; i++) {\n    var value = OlevelSubjects[i] \n    OLevelArray.push({key: value, label: value })\n  } \n\n  const ALevelArray = [];\n  for (let i = 0; i < AlevelSubjects.length; i++) {\n    var value = AlevelSubjects[i] \n    ALevelArray.push({key: value, label: value })\n  } \n\n  const weekdayArray = [\n    {key: \"Monday\", label: \"Monday\"},\n    {key: \"Tuesday\", label: \"Tuesday\"},\n    {key: \"Wednesday\", label: \"Wednesday\"},\n    {key: \"Thursday\", label: \"Thursday\"},\n    {key: \"Friday\", label: \"Friday\"},\n    {key: \"Saturday\", label: \"Saturday\"},\n    {key: \"Sunday\", label: \"Sunday\"},\n  ];\n\n\n  const [successful, setSuccessful] = useState(false);\n  const [message, setMessage] = useState(\"\");\n  const navigate = useNavigate();\n\n\n  const onChangeEmail = (e) => {\n    const email = e.target.value;\n    setEmail(email);\n  };\n\n  const onChangeName = (e) => {\n    const name = e.target.value;\n    setName(name);\n  };\n\n  const onChangePassword = (e) => {\n    const password = e.target.value;\n    setPassword(password);\n  };\n\n  const onChangeHourlyRate = (e) => {\n    const hourlyRate = e.target.value;\n    setHourlyRate(hourlyRate)\n    document.getElementById(\"hourlyRate\").textContent = \"$\"+hourlyRate\n  }\n\n  const onChangeStartTime = (e) => {\n    const startTime = new Date(e * 1000).toISOString().substring(11, 16)\n\n    // Add 30 mins \n    const startForEndTime = new Date((e + 1800) * 1000).toISOString().substring(11, 16)\n\n    setStartTime(startTime)\n    setStartForEndTime(startForEndTime)\n  }\n\n  const onChangeEndTime = (e) => {\n    const endTime = new Date(e * 1000).toISOString().substring(11, 16)\n    setEndTime(endTime)\n  }\n\n  const OnChangePSLE = (subject) => {\n    let updated = selectedSubjects\n    updated[\"PSLE\"] = subject\n    setSelectedSubjects(selectedSubjects => ({\n      ...updated\n    }));\n  }\n\n  const onChangeOlevel = (subject) => {\n    let updated = selectedSubjects\n    updated[\"O-Level\"] = subject\n    setSelectedSubjects(selectedSubjects => ({\n      ...updated\n    }));\n  }\n\n  const onChangeAlevel = (subject) => {\n    let updated = selectedSubjects\n    updated[\"A-Level\"] = subject\n    setSelectedSubjects(selectedSubjects => ({\n      ...updated\n    }));\n  }\n\n  const onChangeWeekDays = (weekdays) => {\n    let updatedValue = {};\n    for (var i=0; i<weekdays.length; i++) {\n      updatedValue[weekdays[i]] = {\n        \"start\": \"\", \"end\": \"\"\n      }\n    }\n    setAvailability(availability => ({\n          ...updatedValue\n        }));\n  }\n\n  const handleUploadFiles = files => {\n    const uploaded = [...uploadedFiles];\n    let limitExceeded = false;\n    files.some((file) => {\n        if (uploaded.findIndex((f) => f.name === file.name) === -1) {\n            uploaded.push(file);\n            if (uploaded.length === MAX_COUNT) setFileLimit(true);\n            if (uploaded.length > MAX_COUNT) {\n                alert(`You can only add a maximum of ${MAX_COUNT} files`);\n                setFileLimit(false);\n                limitExceeded = true;\n                return true;\n            }\n        }\n    })\n    if (!limitExceeded) setUploadedFiles(uploaded)\n  }\n\n  const handleFileEvent =  (e) => {\n    const chosenFiles = Array.prototype.slice.call(e.target.files)\n    handleUploadFiles(chosenFiles);\n}\n\n  const handleRegister = (e) => {\n    e.preventDefault();\n    setMessage(\"\");\n    setSuccessful(false);\n\n    form.current.validateAll();\n\n    //validate\n    if (uploadedFiles.length == 0) {\n      alert(\"Please uploade at least 1 file!\");\n    }\n\n    // If passed validation, call auth service to send the API request\n    \n    if (checkBtn.current.context._errors.length === 0) {\n\n      // Consolidate the availbility\n      let updatedValue = availability\n      var weekdays = Object.keys(availability)\n      for (var i=0; i<weekdays.length; i++) {\n        updatedValue[weekdays[i]][\"start\"] = startTime\n        updatedValue[weekdays[i]][\"end\"] = endTime\n      }\n      setAvailability(availability => ({\n            ...availability,\n            ...updatedValue\n          }));\n      \n      // upload the file to firebase storage\n      for (var i=0; i<uploadedFiles.length;i++) {\n        const storageRef = ref(storage, `/${email}/${uploadedFiles[i].name}`)\n        const uploadTask = uploadBytesResumable(storageRef, uploadedFiles[i]);\n\n        uploadTask.on(\n          \"state_changed\",\n          () => {},\n          (err) => console.log(err),\n          () => {\n              getDownloadURL(uploadTask.snapshot.ref).then((url) => {\n                const uploaded = uploadedURLs\n                uploaded.push(url)\n                setUploadedURLs(uploaded);\n              });\n            })\n            if (uploadedURLs.length === uploadedFiles.length){\n\n              alert(\"Files uploaded successfully!\")\n              AuthService.register_tutor(name, email, password, hourlyRate, availability, selectedSubjects, uploadedURLs).then(\n                (response) => {\n                  if (response.status === 200) {\n                    setMessage(\"Registered Successfully!\");\n                    setSuccessful(true);\n                    setTimeout(function () {\n                      navigate(\"/login\");\n                      window.location.reload();\n                    }, 2000);\n                  } else {\n                    setMessage(\"Error, try again!\");\n                    setSuccessful(false);\n                    setTimeout(function () {\n                      setMessage(\"\");\n                    }, 5000);\n                  }\n                },\n                (error) => {\n                  var resMessage = \"\"\n                  if (error.response.status === 406) {\n                    resMessage = \"This email has been registered!\"\n                  } else {\n                    resMessage =\n                    (error.response &&\n                      error.response.data &&\n                      error.response.data.message) ||\n                    error.message ||\n                    error.toString();\n                  }\n                  setMessage(resMessage);\n                  setSuccessful(false);\n                }\n              );\n          }\n        }\n    }\n  };\n\n  return (\n        <Form onSubmit={handleRegister} ref={form}>\n          <h3>Register Tutor</h3>\n          {!successful && (\n\n            <div>\n              <hr className=\"hr\" />\n              <h4>Basic Details</h4>\n              <div className=\"mb-3\">\n                <label htmlFor=\"name\">Name</label>\n                <Input\n                  type=\"text\"\n                  className=\"form-control\"\n                  name=\"name\"\n                  value={name}\n                  onChange={onChangeName}\n                  validations={[required]}\n                />\n              </div>\n\n              <div className=\"mb-3\">\n                <label htmlFor=\"email\">Email</label>\n                <Input\n                  type=\"text\"\n                  name=\"email\"\n                  className=\"form-control\"\n                  value={email}\n                  onChange={onChangeEmail}\n                  validations={[required, validEmail]}\n                />\n              </div>\n\n              <div className=\"mb-3\">\n                <label htmlFor=\"password\">Password</label>\n                <Input\n                  type=\"password\"\n                  className=\"form-control\"\n                  name=\"password\"\n                  value={password}\n                  onChange={onChangePassword}\n                  validations={[required, vpassword]}\n                />\n              </div>\n\n              <div className=\"mb-3\">\n                <label htmlFor=\"hourlyrate\">Indicated Hourly Rate<div id=\"hourlyRate\">$50</div></label>\n                <Input\n                  type=\"range\"\n                  min=\"10\"\n                  max=\"100\"\n                  className=\"form-control\"\n                  step={5}\n                  value={hourlyRate}\n                  onChange={onChangeHourlyRate}\n                  validations={[required]}\n                   />\n              </div>\n\n              <hr className=\"hr\" />\n              <h4>Availabilities</h4>\n              <div className=\"mb-3\">\n                <div className=\"mb-4\" id=\"addAvail\">\n\n                  <DropdownMultiselect \n                    options={weekdayArray} \n                    name=\"weekdayArray\"\n                    handleOnChange={(selected) => {\n                    onChangeWeekDays(selected);\n                  }}\n                    validations= {[required]}\n                  />\n\n                  <label>Start</label>\n                  <TimePicker \n                      initialValue=\"08:00\"\n                      start=\"00:00\"\n                      end=\"23:59\"\n                      step={30} \n                      value={startTime}\n                      onChange={onChangeStartTime}\n                      validations={[required]}\n                      />\n                  <label>End</label>\n                  <TimePicker \n                      initialValue=\"10:00\"\n                      start={startForEndTime}\n                      end=\"23:59\"\n                      step={30} \n                      value={endTime}\n                      onChange={onChangeEndTime}\n                      validations={[required]}\n                      />\n                </div>\n              </div>\n\n              <hr className=\"hr\"></hr>\n              <h4>Proficient Subjects</h4>\n              <div className=\"mb-3\">\n                  <label htmlFor=\"options\">PSLE</label>\n                  <DropdownMultiselect options={PSLEArray} name=\"pslesubjects\" \n                  handleOnChange={(selected) => {\n                    OnChangePSLE(selected);\n                  }}/>\n              </div>\n\n              <div className=\"mb-3\">\n                  <label htmlFor=\"options\">O-Level</label>\n                  <DropdownMultiselect options={OLevelArray} name=\"olevelsubjects\"\n                  handleOnChange={(selected) => {\n                    onChangeOlevel(selected);\n                  }}/>\n              </div>\n\n              <div className=\"mb-3\">\n                  <label htmlFor=\"options\">A-Level</label>\n                  <DropdownMultiselect options={ALevelArray} name=\"alevelsubjects\"\n                  handleOnChange={(selected) => {\n                    onChangeAlevel(selected);\n                  }}/>\n              </div>\n\n              <hr className=\"hr\" />\n              <h4>Certificate of Evidence</h4>\n              <div className=\"alert alert-primary\" role=\"alert\"> \n                <p className=\"mb-0\"> \n                  You may submit any document proving your ability as a Tutor for subjects indicated above\n                </p>\n              </div>\n\n              <div className=\"mb-3\">\n                <input \n                className=\"form-control\" \n                type=\"file\" \n                multiple\n                id=\"formFileMultiple\" \n                onChange={handleFileEvent}\n                disabled={fileLimit}\n                 />\n                <div className=\"uploaded-files-list\">\n                    {uploadedFiles.map(file => (\n                      <div >\n                          {file.name}\n                      </div>))}\n                  </div>\n                </div>\n              \n              \n\n              <div className=\"d-grid\">\n                <button className=\"btn btn-success btn-block\">Register</button>\n              </div>\n            </div>\n          )}\n\n          {message && (\n            <div className=\"mb-3\">\n              <div\n                className={\n                  successful ? \"alert alert-success\" : \"alert alert-danger\"\n                }\n                role=\"alert\"\n              >\n                {message}\n              </div>\n            </div>\n          )}\n          <CheckButton style={{ display: \"none\" }} ref={checkBtn} />\n        </Form>\n  );\n};\n\nexport default RegisterTutor"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}