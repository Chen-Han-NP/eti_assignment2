{"ast":null,"code":"import { upload } from \"@testing-library/user-event/dist/upload\";\nimport axios from \"axios\";\nconst CHATTING_URL = \"https://chatting-4dcnj7fm6a-uc.a.run.app/api/\";\naxios.defaults.withCredentials = true;\nlet axiosConfig = {\n  headers: {\n    'Content-Type': 'text/plain'\n    // \"Access-Control-Allow-Origin\": \"http://localhost:3000\"\n  },\n\n  withCredentials: true\n};\nconst createChatList = () => {\n  return axios.post(CHATTING_URL + \"createchatlist\", {}, axiosConfig).then(response => {\n    return response;\n  });\n};\nconst getChatList = (user_id, user_type) => {\n  return axios.get(CHATTING_URL + \"getlist/\" + user_id + \"/\" + user_type, axiosConfig).then(response => {\n    localStorage.setItem(\"chatList\", JSON.stringify(response.data));\n    return response;\n  });\n};\nconst sendMsg = (user_id, opp_user_id, user_type, content) => {\n  return axios.post(CHATTING_URL + \"sendmessages/\" + user_id + \"/\" + opp_user_id + \"/\" + user_type, {\n    \"content\": content\n  }, axiosConfig).then(response => {\n    return response;\n  });\n};\nconst getCurrentChatList = () => {\n  return JSON.parse(localStorage.getItem(\"chatList\"));\n};\nconst updateChatList = (chatId, message) => {\n  var chatList = JSON.parse(localStorage.getItem(\"chatList\"));\n  for (var i = 0; i < chatList.length; i++) {\n    if (chatList[i].chat_id === chatId) {\n      if (chatList[i].messages === null) {\n        chatList[i].messages = [message];\n      } else {\n        chatList[i].messages.push(message);\n      }\n      localStorage.setItem(\"chatList\", JSON.stringify(chatList));\n      return chatList;\n    }\n  }\n};\nconst ChattingServices = {\n  createChatList,\n  sendMsg,\n  getChatList,\n  getCurrentChatList,\n  updateChatList\n};\nexport default ChattingServices;","map":{"version":3,"names":["upload","axios","CHATTING_URL","defaults","withCredentials","axiosConfig","headers","createChatList","post","then","response","getChatList","user_id","user_type","get","localStorage","setItem","JSON","stringify","data","sendMsg","opp_user_id","content","getCurrentChatList","parse","getItem","updateChatList","chatId","message","chatList","i","length","chat_id","messages","push","ChattingServices"],"sources":["/Users/chenhan/Desktop/eti_assignment2/React/src/services/chatting.service.js"],"sourcesContent":["import { upload } from \"@testing-library/user-event/dist/upload\";\nimport axios from \"axios\";\n\nconst CHATTING_URL = \"https://chatting-4dcnj7fm6a-uc.a.run.app/api/\"\n\naxios.defaults.withCredentials = true\n\nlet axiosConfig = {\n    headers: {\n        'Content-Type': 'text/plain',\n       // \"Access-Control-Allow-Origin\": \"http://localhost:3000\"\n    },\n    withCredentials : true,\n}\n\n\nconst createChatList = () => {\n    return axios.post(CHATTING_URL + \"createchatlist\",  {},\n    axiosConfig).then(\n        (response) => {\n            return response;\n        }\n    )\n}\n\n \nconst getChatList = (user_id, user_type) => {\n    return axios.get(CHATTING_URL + \"getlist/\" + user_id + \"/\" + user_type, \n        axiosConfig)\n            .then((response) => {\n                localStorage.setItem(\"chatList\", JSON.stringify(response.data));\n        return response;\n      });\n};\n\nconst sendMsg = (user_id, opp_user_id, user_type, content) => {\n    return axios.post(CHATTING_URL + \"sendmessages/\" + user_id + \"/\" + opp_user_id + \"/\" + user_type, { \"content\": content},\n        axiosConfig)\n            .then((response) => {\n        return response;\n      });\n};\n\n\n\nconst getCurrentChatList = () => {\n    return JSON.parse(localStorage.getItem(\"chatList\"));\n};\n\nconst updateChatList = (chatId, message) => {\n    var chatList = JSON.parse(localStorage.getItem(\"chatList\"))\n\n    for (var i = 0; i < chatList.length; i++) {\n        if (chatList[i].chat_id === chatId) {\n            if (chatList[i].messages === null) {\n                chatList[i].messages = [message]\n            } else {\n                chatList[i].messages.push(message)\n            }\n            localStorage.setItem(\"chatList\", JSON.stringify(chatList))\n            return chatList\n        }\n    }\n}\n\n\nconst ChattingServices = {\n    createChatList,\n    sendMsg, \n    getChatList,\n    getCurrentChatList,\n    updateChatList\n}\n\n  \nexport default ChattingServices;\n\n"],"mappings":"AAAA,SAASA,MAAM,QAAQ,yCAAyC;AAChE,OAAOC,KAAK,MAAM,OAAO;AAEzB,MAAMC,YAAY,GAAG,+CAA+C;AAEpED,KAAK,CAACE,QAAQ,CAACC,eAAe,GAAG,IAAI;AAErC,IAAIC,WAAW,GAAG;EACdC,OAAO,EAAE;IACL,cAAc,EAAE;IACjB;EACH,CAAC;;EACDF,eAAe,EAAG;AACtB,CAAC;AAGD,MAAMG,cAAc,GAAG,MAAM;EACzB,OAAON,KAAK,CAACO,IAAI,CAACN,YAAY,GAAG,gBAAgB,EAAG,CAAC,CAAC,EACtDG,WAAW,CAAC,CAACI,IAAI,CACZC,QAAQ,IAAK;IACV,OAAOA,QAAQ;EACnB,CAAC,CACJ;AACL,CAAC;AAGD,MAAMC,WAAW,GAAG,CAACC,OAAO,EAAEC,SAAS,KAAK;EACxC,OAAOZ,KAAK,CAACa,GAAG,CAACZ,YAAY,GAAG,UAAU,GAAGU,OAAO,GAAG,GAAG,GAAGC,SAAS,EAClER,WAAW,CAAC,CACPI,IAAI,CAAEC,QAAQ,IAAK;IAChBK,YAAY,CAACC,OAAO,CAAC,UAAU,EAAEC,IAAI,CAACC,SAAS,CAACR,QAAQ,CAACS,IAAI,CAAC,CAAC;IACvE,OAAOT,QAAQ;EACjB,CAAC,CAAC;AACR,CAAC;AAED,MAAMU,OAAO,GAAG,CAACR,OAAO,EAAES,WAAW,EAAER,SAAS,EAAES,OAAO,KAAK;EAC1D,OAAOrB,KAAK,CAACO,IAAI,CAACN,YAAY,GAAG,eAAe,GAAGU,OAAO,GAAG,GAAG,GAAGS,WAAW,GAAG,GAAG,GAAGR,SAAS,EAAE;IAAE,SAAS,EAAES;EAAO,CAAC,EACnHjB,WAAW,CAAC,CACPI,IAAI,CAAEC,QAAQ,IAAK;IACxB,OAAOA,QAAQ;EACjB,CAAC,CAAC;AACR,CAAC;AAID,MAAMa,kBAAkB,GAAG,MAAM;EAC7B,OAAON,IAAI,CAACO,KAAK,CAACT,YAAY,CAACU,OAAO,CAAC,UAAU,CAAC,CAAC;AACvD,CAAC;AAED,MAAMC,cAAc,GAAG,CAACC,MAAM,EAAEC,OAAO,KAAK;EACxC,IAAIC,QAAQ,GAAGZ,IAAI,CAACO,KAAK,CAACT,YAAY,CAACU,OAAO,CAAC,UAAU,CAAC,CAAC;EAE3D,KAAK,IAAIK,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGD,QAAQ,CAACE,MAAM,EAAED,CAAC,EAAE,EAAE;IACtC,IAAID,QAAQ,CAACC,CAAC,CAAC,CAACE,OAAO,KAAKL,MAAM,EAAE;MAChC,IAAIE,QAAQ,CAACC,CAAC,CAAC,CAACG,QAAQ,KAAK,IAAI,EAAE;QAC/BJ,QAAQ,CAACC,CAAC,CAAC,CAACG,QAAQ,GAAG,CAACL,OAAO,CAAC;MACpC,CAAC,MAAM;QACHC,QAAQ,CAACC,CAAC,CAAC,CAACG,QAAQ,CAACC,IAAI,CAACN,OAAO,CAAC;MACtC;MACAb,YAAY,CAACC,OAAO,CAAC,UAAU,EAAEC,IAAI,CAACC,SAAS,CAACW,QAAQ,CAAC,CAAC;MAC1D,OAAOA,QAAQ;IACnB;EACJ;AACJ,CAAC;AAGD,MAAMM,gBAAgB,GAAG;EACrB5B,cAAc;EACda,OAAO;EACPT,WAAW;EACXY,kBAAkB;EAClBG;AACJ,CAAC;AAGD,eAAeS,gBAAgB"},"metadata":{},"sourceType":"module","externalDependencies":[]}